# スプレッドシートからcsvを取得するツール
## 使い方
* スプレッドシートにデータを登録

```csv
block_id,block_key,block_name
1,yokohama,横浜市
2,kawasaki,川崎市
3,yokosukamiura,横須賀三浦地区
4,kenoh,県央地区
5,syonan,湘南地区
6,kensei,県西地区
```
* 拡張機能→AppsScriptを開き、新しくスクリプトを作成
* getcsv.gsをメモ帳で開いて貼り付け
* デプロイ→新しいデプロイでウェブアプリを選択し、アクセスできるユーザーを「全員」にして「デプロイ」
    * 表示されるウェブアプリのURLをメモ
* コマンドでcsvがダウンロードできるかどうかテストする

```sh
# コマンドを実行する
curl -sL "{ウェブアプリのURL}?sheetName={シート名}" > test.csv
```

## 注意事項
* シート名は英数字で使用してください
* 数字や日付などが思う通りにならない場合は書式を指定しておいてください

## 複数スプレッドシートのマージ機能(上級者向け)
マスターという名前でシートを追加して次のフォーマットで作成する
```csv
id,グループ名,スプシID,signboard,boardlog,signboardstatus,,,（procで指定する名前)
(英数字),(LINE BOTで2列目に指定するグループ名),保管するスプレッドシートID,マージ対象のシート,,,
all,xxxxxxxxxxxxxx,掲示板,活動ログ,ステータスと色,,,
```

```sh
# コマンドを実行する
curl -sL "{ウェブアプリのURL}?proc=signboard" > signboard.csv
```


## 更新履歴
2025.3.15 初期バージョン公開
2025.4.6 複数スプレッドシートのマージ機能を追加